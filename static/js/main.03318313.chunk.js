(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,n){e.exports=n(350)},350:function(e,t,n){"use strict";n.r(t);var s=n(143),r=n(1),o=n.n(r),c=n(105),a=n.n(c),i=(n(331),n(332),n(106)),l=n(50),u=n(51),f=n(53),d=n(52),h=n(54),p=n(2),m=(n(349),n(144)),v=n.n(m),b=function(e,t){return v()(function(e,t){var n="";return Object.keys(t).forEach(function(e){return n+="".concat(e,"=").concat(t[e],"&")}),"https://api.vk.com/method/".concat(e,"?").concat(n,"v=5.80")}(e,t)).then(function(e){return e.json()}).catch(function(e){return console.error(e)})},k=function(e){return b("users.get",e)},E=function(e){return b("friends.get",e)},I=function(e){return b("friends.getRequests",e)},g=function(e){return b("friends.delete",e)},_=function(e){var t=e.id,n=e.go,s=e.fetchedUser;return o.a.createElement(p.Panel,{id:t},o.a.createElement(p.PanelHeader,null,"\u0412\u041a \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"),s&&o.a.createElement(p.Group,{title:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"},o.a.createElement(p.ListItem,{before:s.photo_200?o.a.createElement(p.Avatar,{src:s.photo_200}):null,description:s.city&&s.city.title?s.city.title:""},"".concat(s.first_name," ").concat(s.last_name))),o.a.createElement(p.Group,{title:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},o.a.createElement(p.Div,null,o.a.createElement(p.Button,{size:"xl",level:"2",onClick:n,"data-to":"friends"},"\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438")),o.a.createElement(p.Div,null,o.a.createElement(p.Button,{size:"xl",level:"2",onClick:n,"data-to":"subscribers"},"\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u0437\u0430\u044f\u0432\u043a\u043c\u0438 \u0432 \u0434\u0440\u0443\u0437\u044c\u044f")),o.a.createElement(p.Div,null,o.a.createElement(p.Button,{size:"xl",level:"2",onClick:n,"data-to":"friends"},"\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u0430\u043c\u0438"))))},y=n(72),F=n.n(y),S=n(59),j=n.n(S),C=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={progress:0,countFriends:0,isDelAllFriends:!1},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"deleteFriend",value:function(e){var t=this;return function(){g({user_id:e,access_token:t.props.access_token}).then(function(n){if(n.error)console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",n.error);else{var s=t.props.usersInfo.findIndex(function(t){return t.id===e});t.props.usersInfo.splice(s,1),t.forceUpdate()}}).catch(function(e){return console.error(e)})}}},{key:"deleteAllFriends",value:function(){var e=this,t=!this.props.usersInfo.length;this.setState({isDelAllFriends:!0}),this.interval=setInterval(function(){t&&clearInterval(e.interval),g({user_id:e.props.usersInfo[0].id,access_token:e.props.access_token}).then(function(t){t.error?console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",t.error):(e.props.usersInfo.splice(0,1),e.setState(function(e){return e.progress++}),e.forceUpdate())}).catch(function(e){return console.error(e)})},3e3)}},{key:"cancelDelFriends",value:function(){clearInterval(this.interval),this.setState({isDelAllFriends:!1})}},{key:"componentDidMount",value:function(){this.setState({countFriends:this.props.usersInfo.length})}},{key:"render",value:function(){var e=this;return o.a.createElement(p.Panel,{id:this.props.id},o.a.createElement(p.PanelHeader,{left:o.a.createElement(p.HeaderButton,{onClick:this.props.go,"data-to":"home"},this.osname===p.IOS?o.a.createElement(F.a,null):o.a.createElement(j.a,null))},"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f."),o.a.createElement(p.Group,{title:""},o.a.createElement(p.Div,{style:{display:"flex",zIndex:100}},o.a.createElement(p.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:this.deleteAllFriends.bind(this)},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435\u0445 \u0434\u0440\u0443\u0437\u0435\u0439"),o.a.createElement(p.Button,{size:"l",stretched:!0,level:"secondary",onClick:this.cancelDelFriends.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f")),this.state.isDelAllFriends&&o.a.createElement(p.Cell,{description:"\u0443\u0434\u0430\u043b\u0435\u043d\u043e ".concat(this.state.progress," / ").concat(this.state.countFriends)},o.a.createElement(p.Progress,{value:this.state.progress}))),o.a.createElement(p.Group,{title:"\u0414\u0440\u0443\u0437\u044c\u044f"},this.props.usersInfo.map(function(t){return o.a.createElement(p.Cell,{size:"l",description:t.status||"\u0421\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d",before:o.a.createElement(p.Avatar,{src:t.photo_200_orig}),bottomContent:o.a.createElement(p.Button,{onClick:e.deleteFriend(t.id)},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),key:t.id},"".concat(t.first_name," ").concat(t.last_name))})))}}]),t}(o.a.Component),D=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={progress:0,countFriends:0,isDelAllFriends:!1},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"deleteFriend",value:function(e){var t=this;return function(){g({user_id:e,access_token:t.props.access_token}).then(function(n){if(n.error)console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",n.error);else{var s=t.props.usersInfo.findIndex(function(t){return t.id===e});t.props.usersInfo.splice(s,1),t.forceUpdate()}}).catch(function(e){return console.error(e)})}}},{key:"deleteAllFriends",value:function(){var e=this,t=!this.props.usersInfo.length;this.setState({isDelAllFriends:!0}),this.interval=setInterval(function(){t&&clearInterval(e.interval),g({user_id:e.props.usersInfo[0].id,access_token:e.props.access_token}).then(function(t){t.error?console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",t.error):(e.props.usersInfo.splice(0,1),e.setState(function(e){return e.progress++}),e.forceUpdate())}).catch(function(e){return console.error(e)})},3e3)}},{key:"cancelDelFriends",value:function(){clearInterval(this.interval),this.setState({isDelAllFriends:!1})}},{key:"componentDidMount",value:function(){this.setState({countFriends:this.props.usersInfo.length})}},{key:"render",value:function(){var e=this;return o.a.createElement(p.Panel,{id:this.props.id},o.a.createElement(p.PanelHeader,{left:o.a.createElement(p.HeaderButton,{onClick:this.props.go,"data-to":"home"},this.osname===p.IOS?o.a.createElement(F.a,null):o.a.createElement(j.a,null))},"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f."),o.a.createElement(p.Group,{title:""},o.a.createElement(p.Div,{style:{display:"flex",zIndex:100}},o.a.createElement(p.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:this.deleteAllFriends.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u0441\u0435 \u0437\u0430\u044f\u0432\u043a\u0438 \u0432 \u0434\u0440\u0443\u0437\u044c\u044f"),o.a.createElement(p.Button,{size:"l",stretched:!0,level:"secondary",onClick:this.cancelDelFriends.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430")),this.state.isDelAllFriends&&o.a.createElement(p.Cell,{description:"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u043e ".concat(this.state.progress," / ").concat(this.state.countFriends)},o.a.createElement(p.Progress,{value:this.state.progress}))),o.a.createElement(p.Group,{title:"\u0418\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0437\u0430\u044f\u0432\u043a\u0438 \u0432 \u0434\u0440\u0443\u0437\u044c\u044f"},this.props.usersInfo.map(function(t,n){return o.a.createElement(p.Cell,{size:"l",description:t.status||"\u0421\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d",before:o.a.createElement(p.Avatar,{src:t.photo_200_orig}),bottomContent:o.a.createElement(p.Button,{onClick:e.deleteFriend(t.id)},"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"),key:n},"".concat(t.first_name," ").concat(t.last_name))})))}}]),t}(o.a.Component),O=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(f.a)(this,Object(d.a)(t).call(this,e))).go=function(e){n.setState({activePanel:e.currentTarget.dataset.to})},n.state={activePanel:"home",fetchedUser:null,access_token:"10e034eddee1017397f6fb967350f1daf7621e9f3387c100763dbd90ec76dff932db8d2c5732c3b9f33bc",friendsIds:null,usersInfo:[],subscribersInfo:[],countSubscribers:0},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getFriends(),this.getUserInfo(),this.getSubscribers()}},{key:"getSubscribers",value:function(){var e=this,t=0;this.subscribersInterval=setInterval(function(){e.state.countSubscribers;I({count:100,offset:t,out:1,access_token:e.state.access_token}).then(function(n){t+=100,e.setState({countSubscribers:n.response.count}),e.getUsersInfo(n.response.items).then(function(t){e.setState(function(e){var n;(n=e.subscribersInfo).push.apply(n,Object(i.a)(t.response))})}).catch(function(e){return console.error(e)})}).catch(function(e){return console.error(e)})},3e3)}},{key:"getFriends",value:function(){var e=this;E({count:5e3,access_token:this.state.access_token}).then(function(t){e.setState({friendsIds:t.response.items}),e.getUsersInfo(t.response.items).then(function(t){e.setState(function(e){var n;(n=e.usersInfo).push.apply(n,Object(i.a)(t.response))})}).catch(function(e){return console.error(e)})}).catch(function(e){return console.error(e)})}},{key:"getUserInfo",value:function(){var e=this;k({fields:"photo_200,status,city",access_token:this.state.access_token}).then(function(t){e.setState({fetchedUser:t.response[0]})}).catch(function(e){return console.error(e)})}},{key:"getUsersInfo",value:function(e){var t=e.slice(0,100).join(",");return k({user_ids:t,fields:"photo_200_orig,status",access_token:this.state.access_token})}},{key:"render",value:function(){return o.a.createElement(p.View,{activePanel:this.state.activePanel},o.a.createElement(_,{id:"home",fetchedUser:this.state.fetchedUser,go:this.go,access_token:this.state.access_token}),o.a.createElement(C,{id:"friends",go:this.go,access_token:this.state.access_token,usersInfo:this.state.usersInfo}),o.a.createElement(D,{id:"subscribers",go:this.go,access_token:this.state.access_token,usersInfo:this.state.subscribersInfo}))}}]),t}(o.a.Component);s.a.send("VKWebAppInit",{}).then(function(e){return console.log("VKWebAppInit success:",e)}).catch(function(e){return console.error("VKWebAppInit error:",e)}),a.a.render(o.a.createElement(O,null),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.03318313.chunk.js.map
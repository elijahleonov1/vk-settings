{"version":3,"sources":["store/user/actionType.js","store/user/reducer.js","store/friends/actionType.js","store/friends/reducer.js","store/reducers.js","utils/api/vk.js","store/user/action.js","store/friends/action.js","components/User.js","containers/HomeContainer.js","containers/Friends/FriendsContainer.js","App.js","index.js"],"names":["SET_USER","userInitialState","photo_200","first_name","last_name","city","title","user","state","arguments","length","undefined","action","type","Object","objectSpread","payload","getUser","FETCHED_FRIENDS","UPDATE_FRIENDS","users","friends","toConsumableArray","concat","getFriends","combineReducers","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","response","wrap","_context","prev","next","connect","send","sent","data","abrupt","t0","Error","stop","apply","this","_ref2","_callee2","count","offset","response1","access_token","params","_args2","_context2","app_id","scope","v","fields","method","items","fetchedUser","dispatch","_x","fetchedFriends","setFetching","updateFriends","_x2","User","_ref$size","size","id","photo_50","photo_100","photo_200_orig","_fetchedUser$city","bdate","photo","react_default","createElement","vkui","key","before","src","description","bottomContent","rootSelects","props","go","useEffect","rootActions","useFetchedUser","components_User","expandable","onClick","data-to","offsetFriends","_useState","useState","_useState2","slicedToArray","isFetching","setIsFetching","osname","platform","window","addEventListener","handleScroll","e","scrollHeight","document","documentElement","clientHeight","scrollY","left","IOS","chevron_back_default","back_default","onScroll","onRefresh","map","App","activePanel","setActivePanel","currentTarget","dataset","to","HomeContainer","Friends_FriendsContainer","store","createStore","rootReducer","applyMiddleware","thunk","localStorage","getItem","setItem","console","log","fetchedAccessToken","ReactDOM","render","es","src_App","getElementById"],"mappings":"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","file":"static/js/main.0d09fb96.chunk.js","sourcesContent":["export const SET_USER = 'SET_USER';","import { SET_USER } from './actionType';\r\n\r\nconst userInitialState = {\r\n\tphoto_200: 'https://pp.userapi.com/c841034/v841034569/3b8c1/pt3sOw_qhfg.jpg',\r\n\tfirst_name: 'Вася',\r\n\tlast_name: 'Васечкин',\r\n\tcity: { title: 'New York' }\r\n};\r\n\r\nexport default function user (state = userInitialState, action = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase SET_USER:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...action.payload\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t};\r\n};\r\n\r\nexport const getUser = (state) => {\r\n\treturn state.user;\r\n};","export const FETCHED_FRIENDS = 'FETCHED_FRIENDS';\r\nexport const UPDATE_FRIENDS = 'UPDATE_FRIENDS';","import { FETCHED_FRIENDS, UPDATE_FRIENDS } from './actionType';\r\n\r\nconst userInitialState = {\r\n\tusers: []\r\n};\r\n\r\n\r\nexport default function friends (state = userInitialState, action = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase FETCHED_FRIENDS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: [...action.users]\r\n\t\t\t};\r\n\t\tcase UPDATE_FRIENDS:\r\n\t\tdebugger\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: [...state.users, ...action.users]\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t};\r\n};\r\n\r\nexport const getFriends = (state) => {\r\n\treturn state.friends.users;\r\n};","import {combineReducers} from 'redux';\r\nimport user, * as selectUser from './user/reducer';\r\nimport friends, * as selectFriends from './friends/reducer';\r\n\r\nexport default combineReducers({\r\n\tuser,\r\n\tfriends\r\n});\r\n\r\nexport {\r\n\tselectUser,\r\n\tselectFriends\r\n}","import connect from '@vkontakte/vkui-connect-promise';\r\n\r\nconst v = '5.95';\r\n// const access_token = localStorage.getItem('access_token');\r\n\r\nexport const getUser = async () => {\r\n\ttry{\r\n\t\tconst response = await connect.send(\"VKWebAppGetUserInfo\", {});\r\n\t\treturn await response.data;\r\n\t} catch(err) {\r\n\t\tthrow Error(err);\r\n\t}\r\n};\r\n\r\nexport const getFriends = async (count=100, offset=0) => {\r\n\ttry{\r\n\t\tconst response1 = await connect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 6940370, \"scope\": \"friends\"});\r\n\t\tconst access_token = await response1.data.access_token;\r\n\t\tconst method = 'friends.get';\r\n\t\tconst fields = 'nickname,domain,sex,bdate,city,country,timezone,photo_50,photo_100,photo_200_orig,has_mobile,contacts,education,online,relation,last_seen,status,can_write_private_message,can_see_all_posts,can_post,universities';\r\n\t\tconst params = {access_token, v, fields, count, offset};\r\n\t\tconst response = await connect.send('VKWebAppCallAPIMethod', {method, params});\r\n\t\treturn await response.data.response.items;\r\n\t} catch (err) {\r\n\t\tthrow Error(err);\r\n\t}\r\n};","import {SET_USER} from './actionType';\r\nimport {getUser} from '../../utils/api/vk';\r\n\r\nexport const fetchedUser = () => async (dispatch) => {\r\n\tconst data = await getUser();\r\n\tdispatch({type: SET_USER, payload: data});\r\n};","import { FETCHED_FRIENDS, UPDATE_FRIENDS } from './actionType';\r\nimport {getFriends} from '../../utils/api/vk';\r\n\r\nexport const fetchedFriends = (setFetching) => async (dispatch) => {\r\n\tconst data = await getFriends();\r\n\tdispatch({type: FETCHED_FRIENDS, users: data});\r\n\tif (setFetching) {\r\n\t\tsetFetching();\r\n\t}\r\n};\r\n\r\nexport const updateFriends = (offset=0) => async (dispatch) => {\r\n\tconst data = await getFriends(100, offset);\r\n\tdispatch({type: UPDATE_FRIENDS, users: [...data]});\r\n};","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Cell, Avatar} from '@vkontakte/vkui';\r\n\r\nconst  User = ({size=40, fetchedUser}) => {\r\n\tconst {\r\n\t\tid,\r\n\t\tphoto_50,\r\n\t\tphoto_100,\r\n\t\tphoto_200,\r\n\t\tphoto_200_orig,\r\n\t\tcity = {title: ''},\r\n\t\tfirst_name,\r\n\t\tlast_name,\r\n\t\tbdate\r\n\t} = fetchedUser;\r\n\tconst photo = photo_200_orig || photo_200 || photo_100 || photo_50;\r\n\treturn (\r\n\t\t<Cell\r\n\t\t\tkey={id}\r\n\t\t\tbefore={<Avatar size={size} src={photo} />}\r\n\t\t\tsize=\"l\"\r\n\t\t\tdescription={city.title}\r\n\t\t\tbottomContent={bdate && `День рождения: ${bdate}`}\r\n\t\t>\r\n\t\t\t{`${first_name} ${last_name}`}\r\n\t\t</Cell>\r\n\t);\r\n}\r\n\r\nUser.propTypes = {\r\n\tfetchedUser: PropTypes.shape({\r\n\t\tid: PropTypes.number,\r\n\t\tsize: PropTypes.number,\r\n\t\tphoto_50: PropTypes.string,\r\n\t\tphoto_100: PropTypes.string,\r\n\t\tphoto_200: PropTypes.string,\r\n\t\tphoto_200_orig: PropTypes.string,\r\n\t\tfirst_name: PropTypes.string,\r\n\t\tlast_name: PropTypes.string,\r\n\t\tbdate: PropTypes.string,\r\n\t\tcity: PropTypes.shape({\r\n\t\t\ttitle: PropTypes.string,\r\n\t\t})\r\n\t})\r\n};\r\n\r\nexport default User;","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {connect} from 'react-redux';\r\n\r\nimport * as rootSelects from '../store/reducers';\r\nimport * as rootActions from '../store/actions';\r\n\r\nimport {Panel, List, Group, PanelHeader, Cell} from '@vkontakte/vkui';\r\n\r\nimport User from '../components/User';\r\n\r\nconst useFetchedUser = (dispatch) => {\r\n\tuseEffect(() => {\r\n\t\tconst {\r\n\t\t\tuserActions: {fetchedUser}\r\n\t\t} = rootActions;\r\n\r\n\t\tdispatch(fetchedUser());\r\n\t}, []);\r\n};\r\n\r\nconst Home = (props) => {\r\n\tconst {id, go, fetchedUser, dispatch} = props;\r\n\tuseFetchedUser(dispatch);\r\n\r\n\treturn(\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>Главная</PanelHeader>\r\n\r\n\t\t\t<Group title=\"\">\r\n\t\t\t\t<User size={48} fetchedUser={fetchedUser} go={go} />\r\n\t\t\t</Group>\r\n\r\n\t\t\t<Group title=\"Переходы\">\r\n\t\t\t\t<List>\r\n\t\t\t\t\t<Cell expandable onClick={go} data-to='friends'>Друзья</Cell>\r\n\t\t\t\t</List>\r\n\t\t\t</Group>\r\n\t\t</Panel>\r\n\t);\r\n}\r\n\r\nHome.propTypes = {\r\n\tid: PropTypes.string.isRequired,\r\n\tgo: PropTypes.func.isRequired\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n\tconst {\r\n\t\tselectUser: {getUser}\r\n\t} = rootSelects;\r\n\r\n\treturn {\r\n\t\tfetchedUser: getUser(state)\r\n\t};\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(Home);\r\n","import React, {useState, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {connect} from 'react-redux';\r\n\r\nimport * as rootSelects from '../../store/reducers';\r\nimport * as rootActions from '../../store/actions';\r\n\r\nimport {\r\n\tPanel,\r\n\tPanelHeader,\r\n\tHeaderButton,\r\n\tplatform,\r\n\tIOS,\r\n\tFooter,\r\n\tPullToRefresh,\r\n\tGroup,\r\n\tList,\r\n} from '@vkontakte/vkui';\r\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\r\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\r\n\r\nimport User from '../../components/User';\r\n\r\nconst FriendsContainer = (props) => {\r\n\tlet offsetFriends = 100;\r\n\tconst {id, go, users, dispatch,} = props;\r\n\tconst [isFetching, setIsFetching] = useState(false);\r\n\tconst osname = platform();\r\n\tconst {\r\n\t\tfrendsActions: {updateFriends, fetchedFriends}\r\n\t} = rootActions;\r\n\r\n\tuseEffect(() => {\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\tdispatch(fetchedFriends(setFetching));\r\n\t}, []);\r\n\r\n\tconst onRefresh = () => {\r\n\t\tsetIsFetching(true);\r\n\t\tdispatch(fetchedFriends(setFetching));\r\n\t};\r\n\r\n\tconst setFetching = () => setIsFetching(false);\r\n\r\n\tconst handleScroll = (e) => {\r\n\t\tconst scrollHeight = document.documentElement.scrollHeight;\r\n\t\tconst clientHeight = document.documentElement.clientHeight;\r\n\t\tconst scrollY = window.scrollY + 1;\r\n\t\tif (scrollY >= scrollHeight - clientHeight) {\r\n\t\t\tdispatch(updateFriends(offsetFriends));\r\n\t\t\toffsetFriends += 100;\r\n\t\t}\r\n\t}\r\n\r\n\treturn(\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader\r\n\t\t\t\tleft={<HeaderButton onClick={go} data-to=\"home\">\r\n\t\t\t\t\t{osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\r\n\t\t\t\t</HeaderButton>}\r\n\t\t\t>\r\n\t\t\t\tДрузья\r\n\t\t\t</PanelHeader>\r\n\r\n\t\t\t<PullToRefresh\r\n\t\t\t\tonScroll={handleScroll}\r\n\t\t\t\tonRefresh={onRefresh}\r\n\t\t\t\tisFetching={isFetching}>\r\n\t\t\t\t{!!users.length && <Group title=\"\">\r\n\t\t\t\t\t{users.map(user => (\r\n\t\t\t\t\t\t<List key={user.id}>\r\n\t\t\t\t\t\t\t<User fetchedUser={user} go={go} />\r\n\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Group>}\r\n\t\t\t\t<Footer>{users.length} друзей</Footer>\r\n\t\t\t</PullToRefresh>\r\n\t\t</Panel>\r\n\t);\r\n}\r\n\r\nFriendsContainer.propTypes = {\r\n\tid: PropTypes.string.isRequired,\r\n\tgo: PropTypes.func.isRequired\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n\tconst {\r\n\t\tselectFriends: {getFriends}\r\n\t} = rootSelects;\r\n\r\n\treturn {\r\n\t\tusers: getFriends(state)\r\n\t};\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(FriendsContainer);\r\n","import React, {useState} from 'react';\n\nimport {View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport HomeContainer from './containers/HomeContainer';\nimport FriendsContainer from './containers/Friends/FriendsContainer';\n\nconst App = (props) => {\n\tconst [activePanel, setActivePanel] = useState('home');\n\n\tconst go = (e) => setActivePanel(e.currentTarget.dataset.to);\n\n\treturn (\n\t\t<View activePanel={activePanel}>\n\t\t\t<HomeContainer id=\"home\" go={go} />\n\t\t\t<FriendsContainer id=\"friends\" go={go} />\n\t\t</View>\n\t);\n};\n\nexport default App;","import 'core-js/es6/map';\nimport 'core-js/es6/set';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport {createStore, applyMiddleware, compose} from 'redux';\nimport {Provider} from 'react-redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from './store/reducers';\n\nimport connect from '@vkontakte/vkui-connect-promise';\nimport App from './App';\n\nconst store = createStore(rootReducer, applyMiddleware(thunk));\n\nconst CombineApp = () => (\n\t<Provider store={store}>\n\t\t<App />\n\t</Provider>\n);\n\nconnect.send('VKWebAppInit', {});\n\nconst fetchedAccessToken = async () => {\n\tif (!localStorage.getItem('access_token')) {\n\t\tconst response = await connect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 6940370, \"scope\": \"friends\"});\n\t\tconst access_token = await response.data.access_token;\n\t\tlocalStorage.setItem('access_token', access_token);\n\t}\n\tconsole.log('access_token', localStorage.getItem('access_token'));\n};\n\nfetchedAccessToken();\n\nReactDOM.render(<CombineApp />, document.getElementById('root'));\n"],"sourceRoot":""}
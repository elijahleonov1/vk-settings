(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{152:function(e,t,n){e.exports=n(361)},361:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"default",function(){return g}),n.d(r,"getUser",function(){return w});var a={};n.r(a),n.d(a,"default",function(){return y}),n.d(a,"getFriends",function(){return U});var c={};n.r(c),n.d(c,"fetchedUser",function(){return T});var s={};n.r(s),n.d(s,"fetchedFriends",function(){return z}),n.d(s,"updateFriends",function(){return G});var o=n(12),u=n.n(o),i=n(30),l=(n(155),n(157),n(1)),d=n.n(l),p=n(62),f=n.n(p),m=n(48),h=n(56),v=n(150),_=n(63),b="SET_USER",E={photo_200:"https://pp.userapi.com/c841034/v841034569/3b8c1/pt3sOw_qhfg.jpg",first_name:"\u0412\u0430\u0441\u044f",last_name:"\u0412\u0430\u0441\u0435\u0447\u043a\u0438\u043d",city:{title:"New York"}};function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case b:return Object(_.a)({},e,t.payload);default:return e}}var w=function(e){return e.user},O=n(57),j="FETCHED_FRIENDS",k="UPDATE_FRIENDS",x={users:[]};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case j:return Object(_.a)({},e,{users:Object(O.a)(t.users)});case k:return Object(_.a)({},e,{users:[].concat(Object(O.a)(e.users),Object(O.a)(t.users))});default:return e}}var U=function(e){return e.friends.users},F=Object(m.c)({user:g,friends:y}),S=n(49),A=n(77),I=n(9),P=(n(360),function(){var e=Object(i.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.a.send("VKWebAppGetUserInfo",{});case 3:return t=e.sent,e.next=6,t.data;case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(0),Error(e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(){return e.apply(this,arguments)}}()),C=function(){var e=Object(i.a)(u.a.mark(function e(){var t,n,r,a,c,s,o=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:100,n=o.length>1&&void 0!==o[1]?o[1]:0,e.prev=2,e.next=5,S.a.send("VKWebAppGetAuthToken",{app_id:6940370,scope:"friends"});case 5:return r=e.sent,e.next=8,r.data.access_token;case 8:return a=e.sent,"friends.get","nickname,domain,sex,bdate,city,country,timezone,photo_50,photo_100,photo_200_orig,has_mobile,contacts,education,online,relation,last_seen,status,can_write_private_message,can_see_all_posts,can_post,universities",c={access_token:a,v:"5.95",fields:"nickname,domain,sex,bdate,city,country,timezone,photo_50,photo_100,photo_200_orig,has_mobile,contacts,education,online,relation,last_seen,status,can_write_private_message,can_see_all_posts,can_post,universities",count:t,offset:n},e.next=14,S.a.send("VKWebAppCallAPIMethod",{method:"friends.get",params:c});case 14:return s=e.sent,e.next=17,s.data.response.items;case 17:return e.abrupt("return",e.sent);case 20:throw e.prev=20,e.t0=e.catch(2),Error(e.t0);case 23:case"end":return e.stop()}},e,null,[[2,20]])}));return function(){return e.apply(this,arguments)}}(),T=function(){return function(){var e=Object(i.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:n=e.sent,t({type:b,payload:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(i.a)(u.a.mark(function t(n){var r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C();case 2:r=t.sent,n({type:j,users:r}),e&&e();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(){var t=Object(i.a)(u.a.mark(function t(n){var r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(100,e);case 2:r=t.sent,n({type:k,users:Object(O.a)(r)});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},H=function(e){var t=e.size,n=void 0===t?40:t,r=e.fetchedUser,a=r.id,c=r.photo_50,s=r.photo_100,o=r.photo_200,u=r.photo_200_orig,i=r.city,l=void 0===i?{title:""}:i,p=r.first_name,f=r.last_name,m=r.bdate,h=u||o||s||c;return d.a.createElement(I.Cell,{key:a,before:d.a.createElement(I.Avatar,{size:n,src:h}),size:"l",description:l.title,bottomContent:m&&"\u0414\u0435\u043d\u044c \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f: ".concat(m)},"".concat(p," ").concat(f))},V=Object(h.b)(function(e){return{fetchedUser:(0,r.getUser)(e)}},null)(function(e){var t=e.id,n=e.go,r=e.fetchedUser;return function(e){Object(l.useEffect)(function(){e((0,c.fetchedUser)())},[])}(e.dispatch),d.a.createElement(I.Panel,{id:t},d.a.createElement(I.PanelHeader,null,"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"),d.a.createElement(I.Group,{title:""},d.a.createElement(H,{size:48,fetchedUser:r,go:n})),d.a.createElement(I.Group,{title:"\u041f\u0435\u0440\u0435\u0445\u043e\u0434\u044b"},d.a.createElement(I.List,null,d.a.createElement(I.Cell,{expandable:!0,onClick:n,"data-to":"friends"},"\u0414\u0440\u0443\u0437\u044c\u044f"))))}),K=n(151),R=n.n(K),W=n(110),D=n.n(W),L=Object(h.b)(function(e){return{users:(0,a.getFriends)(e)}},null)(function(e){var t=100,n=e.id,r=e.go,a=e.users,c=e.dispatch,o=Object(l.useState)(!1),u=Object(A.a)(o,2),i=u[0],p=u[1],f=Object(I.platform)(),m=s.updateFriends,h=s.fetchedFriends;Object(l.useEffect)(function(){window.addEventListener("scroll",_),c(h(v))},[]);var v=function(){return p(!1)},_=function(e){var n=document.documentElement.scrollHeight,r=document.documentElement.clientHeight;window.scrollY+1>=n-r&&(c(m(t)),t+=100)};return d.a.createElement(I.Panel,{id:n},d.a.createElement(I.PanelHeader,{left:d.a.createElement(I.HeaderButton,{onClick:r,"data-to":"home"},f===I.IOS?d.a.createElement(R.a,null):d.a.createElement(D.a,null))},"\u0414\u0440\u0443\u0437\u044c\u044f"),d.a.createElement(I.PullToRefresh,{onScroll:_,onRefresh:function(){p(!0),c(h(v))},isFetching:i},!!a.length&&d.a.createElement(I.Group,{title:""},a.map(function(e){return d.a.createElement(I.List,{key:e.id},d.a.createElement(H,{fetchedUser:e,go:r}),d.a.createElement("span",null))})),d.a.createElement(I.Footer,null,a.length," \u0434\u0440\u0443\u0437\u0435\u0439")))}),N=function(e){var t=Object(l.useState)("home"),n=Object(A.a)(t,2),r=n[0],a=n[1],c=function(e){return a(e.currentTarget.dataset.to)};return d.a.createElement(I.View,{activePanel:r},d.a.createElement(V,{id:"home",go:c}),d.a.createElement(L,{id:"friends",go:c}))},B=Object(m.d)(F,Object(m.a)(v.a));S.a.send("VKWebAppInit",{}),function(){var e=Object(i.a)(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("access_token")){e.next=8;break}return e.next=3,S.a.send("VKWebAppGetAuthToken",{app_id:6940370,scope:"friends"});case 3:return t=e.sent,e.next=6,t.data.access_token;case 6:n=e.sent,localStorage.setItem("access_token",n);case 8:console.log("access_token",localStorage.getItem("access_token"));case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()(),f.a.render(d.a.createElement(function(){return d.a.createElement(h.a,{store:B},d.a.createElement(N,null))},null),document.getElementById("root"))}},[[152,1,2]]]);
//# sourceMappingURL=main.0d09fb96.chunk.js.map
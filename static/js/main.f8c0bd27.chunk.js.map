{"version":3,"sources":["api/index.js","panels/Home.js","panels/VueFriendsForInstagram.js","panels/VueFriends.js","App.js","index.js"],"names":["Users","opts","connect","send","method","params","Object","objectSpread","v","Friends","Utils","getDateRegistration","id","url","concat","fetchJsonp","then","res","json","catch","error","console","Home","_ref","go","fetchedUser","access_token","react_default","a","createElement","vkui","log","title","before","photo_200","src","description","city","first_name","last_name","size","level","onClick","data-to","VueFriendsForInstagram","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","usersInfo","isSpinner","getFriends","_this2","offsetFriendsInterval","friendsInterval","setInterval","count","offset","data","response","items","length","getUsersInfo","forEach","item","instagram","setState","push","forceUpdate","e","clearInterval","ids","strFriendsIds","slice","join","user_ids","fields","domen","window","open","_this3","left","prev","bind","osname","IOS","chevron_back_default","back_default","style","margin","map","friend","index","key","status","bottomContent","goInstagram","React","Component","_state$usersInfo","apply","toConsumableArray","App","activePanel","currentTarget","dataset","to","subscribe","detail","type","getUser","app_id","scope","panels_Home","panels_VueFriendsForInstagram","VueFriends","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.f8c0bd27.chunk.js","sourcesContent":["import fetchJsonp from 'fetch-jsonp';\r\nimport connect from '@vkontakte/vkui-connect-promise';\r\n\r\nconst getProfilesUrl = (method, opt) => {\r\n    let urlOpts = '';\r\n    let optKeys = Object.keys(opt);\r\n    optKeys.forEach(item => urlOpts += `${item}=${opt[item]}&`);\r\n    return `https://api.vk.com/method/${method}?${urlOpts}v=5.80`\r\n};\r\n\r\nconst API = (method, opt) => {\r\n    return fetchJsonp(getProfilesUrl(method, opt))\r\n      .then(res => res.json())\r\n      .catch(error => console.error(error));\r\n};\r\nconst Account = {\r\n    getInfo (opts) {\r\n        const method = 'account.getInfo';\r\n        return API(method, opts);\r\n    }\r\n};\r\n\r\nconst Users = {\r\n    getUsers (opts) {\r\n        const method = 'users.get';\r\n        // return API(method, opts);\r\n        return connect.send('VKWebAppCallAPIMethod', {method, params: {...opts, v: '5.95'}});\r\n    },\r\n    getFollowers (opts) {\r\n        const method = 'users.getFollowers';\r\n        return API(method, opts);\r\n    }\r\n};\r\n\r\nconst Friends = {\r\n    getFriends (opts) {\r\n        const method = 'friends.get';\r\n        // return API(method, opts);\r\n        return connect.send('VKWebAppCallAPIMethod', {method, params: {...opts, v: '5.95'}});\r\n    },\r\n    getRequests (opts) {\r\n        const method = 'friends.getRequests';\r\n        return API(method, opts);\r\n    },\r\n    deleteFriends (opts) {\r\n        const method = 'friends.delete';\r\n        return API(method, opts);\r\n    }\r\n};\r\n\r\nconst Likes = {\r\n    getLikePosts (opts) {\r\n        const method = 'fave.getPosts';\r\n        return API(method, opts);\r\n    },\r\n    getLikePhotos (opts) {\r\n        const method = 'fave.getPhotos';\r\n        return API(method, opts);\r\n    },\r\n    deleteLike (opts) {\r\n        const method = 'likes.delete';\r\n        return API(method, opts);\r\n    }\r\n};\r\n\r\nconst Utils = {\r\n    getDateRegistration(id) {\r\n        const url = `https://vk.com/foaf.php?id=${id}`;\r\n        return fetchJsonp(url)\r\n            .then(res => res.json())\r\n            .catch(error => console.error(error));\r\n    }\r\n};\r\n\r\nexport {\r\n    Account,\r\n    Users,\r\n    Friends,\r\n    Likes,\r\n    Utils\r\n};","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {Panel, ListItem, Button, Group, Div, Avatar, PanelHeader} from '@vkontakte/vkui';\n\nconst Home = ({id, go, fetchedUser, access_token}) => (\n    <Panel id={id}>\n        {console.log(fetchedUser)}\n        <PanelHeader>VK Tools</PanelHeader>\n        {fetchedUser &&\n        <Group title=\"Ваш аккаунт\">\n            <ListItem\n                before={fetchedUser.photo_200 ? <Avatar src={fetchedUser.photo_200}/> : null}\n                description={fetchedUser.city && fetchedUser.city.title ? fetchedUser.city.title : ''}\n            >\n                {`${fetchedUser.first_name} ${fetchedUser.last_name}`}\n            </ListItem>\n        </Group>}\n\n        <Group title=\"Панель управления\">\n            <Div>\n                <Button size=\"xl\" level=\"2\" onClick={go} data-to=\"friendsForInstagram\">\n                    Друзья в инстаграме\n                </Button>\n            </Div>\n            <Div>\n                <Button size=\"xl\" level=\"2\" onClick={go} data-to=\"friends\">\n                    Друзья\n                </Button>\n            </Div>\n        </Group>\n    </Panel>\n);\n\nHome.propTypes = {\n    id: PropTypes.string.isRequired,\n    go: PropTypes.func.isRequired,\n    fetchedUser: PropTypes.shape({\n        photo_200: PropTypes.string,\n        first_name: PropTypes.string,\n        last_name: PropTypes.string,\n        city: PropTypes.shape({\n            title: PropTypes.string,\n        }),\n    }),\n};\n\nexport default Home;\n","import {\n    Panel,\n    Button,\n    Group,\n    Avatar,\n    PanelHeader,\n    HeaderButton,\n    Cell,\n    IOS,\n    Spinner\n} from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\n\nimport React from 'react';\n\nimport PropTypes from 'prop-types';\n\nimport {Friends, Users} from '../api';\n\nclass VueFriendsForInstagram extends React.Component {\n    constructor (props) {\n        super(props);\n        this.state = {\n            usersInfo: [],\n            isSpinner: true\n        };\n    }\n\n    componentDidMount () {\n        this.getFriends();\n    }\n\n    getFriends () {\n        let countFriendsInterval = 100;\n        let offsetFriendsInterval = 0;\n\n        this.friendsInterval = setInterval(() => {\n\n            Friends.getFriends({\n                count: 100,\n                offset: offsetFriendsInterval,\n                access_token: this.props.access_token,\n            })\n                .then(res => {\n\n                    if(!res.data.response.items.length) {\n                        clearInterval(this.friendsInterval);\n                    } else {\n                        offsetFriendsInterval += countFriendsInterval;\n\n                        this.getUsersInfo(res.data.response.items)\n                            .then(res => {\n                                res.data.response.forEach(item => {\n                                    if (item.instagram) {\n                                        this.setState(state => state.usersInfo.push(item));\n                                    }\n                                });\n                                this.setState({isSpinner: false});\n                                this.forceUpdate();\n                            })\n                            .catch(e => console.log('ERR GET Users', e));\n                    }\n                })\n                .catch(e => console.log('ERR GET Friends', e));\n\n        }, 2000);\n    }\n\n    getUsersInfo (ids) {\n        const strFriendsIds = ids.slice(0, 100).join(',');\n        return Users.getUsers({\n            user_ids: strFriendsIds,\n            fields: 'photo_id, verified, sex, bdate, city, country, home_town, has_photo, photo_50, photo_100, photo_200_orig, photo_200, photo_400_orig, photo_max, photo_max_orig, online, domain, has_mobile, contacts, site, education, universities, schools, status, last_seen, followers_count, common_count, occupation, nickname, relatives, relation, personal, connections, exports, activities, interests, music, movies, tv, books, games, about, quotes, can_post, can_see_all_posts, can_see_audio, can_write_private_message, can_send_friend_request, is_favorite, is_hidden_from_feed, timezone, screen_name, maiden_name, crop_photo, is_friend, friend_status, career, military, blacklisted, blacklisted_by_me',\n            access_token: this.props.access_token\n        });\n    }\n\n    goInstagram (domen) {\n        return window.open(`https://www.instagram.com/${domen}`);\n    }\n\n    prev (e) {\n        clearInterval(this.friendsInterval);\n        this.props.go(e);\n    }\n\n    render () {\n        return (\n            <Panel id={this.props.id}>\n                <PanelHeader\n                    left={<HeaderButton onClick={this.prev.bind(this)} data-to=\"home\">\n                        {this.osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                    </HeaderButton>}\n                >\n                    Друзья\n                </PanelHeader>\n                <Group title={`Друзья в инстаграме ${this.state.usersInfo.length}`}>\n                    {\n                        this.state.isSpinner &&\n                        <Cell size=\"l\">\n                            <Spinner size=\"large\" style={{margin: '150px 0'}}/>\n                        </Cell>\n                    }\n                    {\n                        this.state.usersInfo &&\n                        this.state.usersInfo.map((friend, index) => {\n                            return (\n                                <div key={index}>\n                                    <Cell\n                                        size=\"l\"\n                                        description={friend.status || ''}\n                                        before={<Avatar src={friend.photo_200}/>}\n                                        bottomContent={\n                                            <Button onClick={\n                                                this.goInstagram.bind(this, friend.instagram)\n                                            }>Instagram</Button>\n                                        }\n                                    >\n                                        {`${friend.first_name} ${friend.last_name}`}\n                                    </Cell>\n                                </div>\n                            );\n                        })\n                    }\n                </Group>\n            </Panel>\n        );\n    }\n}\n\nVueFriendsForInstagram.propTypes = {\n    go: PropTypes.func.isRequired,\n    access_token: PropTypes.string.isRequired\n};\n\nexport default VueFriendsForInstagram;\n","import {\n    Panel,\n    Button,\n    Group,\n    Avatar,\n    PanelHeader,\n    HeaderButton,\n    Cell,\n    IOS,\n    Spinner\n} from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\n\nimport React from 'react';\n\nimport PropTypes from 'prop-types';\n\nimport {Friends, Utils} from '../api';\n\nclass VueFriendsForInstagram extends React.Component {\n    constructor (props) {\n        super(props);\n        this.state = {\n            usersInfo: [],\n            isSpinner: true\n        };\n    }\n\n    componentDidMount () {\n        this.getFriends();\n    }\n\n    getFriends () {\n        let countFriendsInterval = 100;\n        let offsetFriendsInterval = 0;\n\n        this.friendsInterval = setInterval(() => {\n\n            Friends.getFriends({\n                count: 100,\n                offset: offsetFriendsInterval,\n                access_token: this.props.access_token,\n            })\n                .then(res => {\n\n                    if(!res.data.response.items.length) {\n                        clearInterval(this.friendsInterval);\n                    } else {\n                        offsetFriendsInterval += countFriendsInterval;\n\n                        res.data.response.items.forEach(id => {\n                            Utils(id)\n                                .then(res => {\n                                    console.log(res);\n                                })\n                                .catch(e => console.log(e));\n                        });\n\n                        this.setState(state => state.usersInfo.push(...res.data.response));\n                    }\n                })\n                .catch(e => console.log('ERR GET Friends', e));\n\n        }, 2000);\n    }\n\n    prev (e) {\n        clearInterval(this.friendsInterval);\n        this.props.go(e);\n    }\n\n    render () {\n        return (\n            <Panel id={this.props.id}>\n                <PanelHeader\n                    left={<HeaderButton onClick={this.prev.bind(this)} data-to=\"home\">\n                        {this.osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                    </HeaderButton>}\n                >\n                    Друзья\n                </PanelHeader>\n                <Group title={`Друзья в инстаграме ${this.state.usersInfo.length}`}>\n                    {\n                        this.state.isSpinner &&\n                        <Cell size=\"l\">\n                            <Spinner size=\"large\" style={{margin: '150px 0'}}/>\n                        </Cell>\n                    }\n                    {\n                        this.state.usersInfo &&\n                        this.state.usersInfo.map((friend, index) => {\n                            return (\n                                <div key={index}>\n                                    <Cell\n                                        size=\"l\"\n                                        description={friend.status || ''}\n                                        before={<Avatar src={friend.photo_200}/>}\n                                        bottomContent={\n                                            <Button>Instagram</Button>\n                                        }\n                                    >\n                                        {`${friend.first_name} ${friend.last_name}`}\n                                    </Cell>\n                                </div>\n                            );\n                        })\n                    }\n                </Group>\n            </Panel>\n        );\n    }\n}\n\nVueFriendsForInstagram.propTypes = {\n    go: PropTypes.func.isRequired,\n    access_token: PropTypes.string.isRequired\n};\n\nexport default VueFriendsForInstagram;\n","import React from 'react';\nimport connect from '@vkontakte/vkui-connect';\nimport {View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport {Users} from './api';\n\nimport Home from './panels/Home';\nimport VueFriendsForInstagram from './panels/VueFriendsForInstagram';\nimport VueFriends from './panels/VueFriends';\n\nclass App extends React.Component {\n    constructor (props) {\n        super(props);\n\n        this.state = {\n            activePanel: 'home',\n            fetchedUser: null,\n            access_token: null\n        };\n    }\n\n    componentDidMount () {\n        connect.subscribe((e) => {\n            switch (e.detail.type) {\n                case 'VKWebAppAccessTokenReceived':\n                    this.setState({ access_token : e.detail.data.access_token });\n                    console.log('access_token', e.detail.data.access_token);\n                    this.getUser();\n                    break;\n                default:\n                    console.log(e.detail);\n            }\n        });\n        connect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 6940370, \"scope\": \"friends,status,wall,groups\"});\n    }\n\n    getUser() {\n        Users.getUsers({\n            fields: 'photo_200,city,title',\n            access_token: this.state.access_token\n        })\n            .then(res => this.setState({ fetchedUser : res.data.response[0]}))\n            .catch(e => console.log('ERR GET User', e));\n    }\n\n    go = (e) => {\n        this.setState({activePanel: e.currentTarget.dataset.to})\n    };\n\n    render () {\n        return (\n            <View activePanel={this.state.activePanel}>\n                <Home id=\"home\" fetchedUser={this.state.fetchedUser} go={this.go} access_token={this.state.access_token}/>\n                <VueFriendsForInstagram\n                    id=\"friendsForInstagram\"\n                    go={this.go}\n                    access_token={this.state.access_token}\n                />\n                <VueFriends\n                    id=\"friends\"\n                    go={this.go}\n                    access_token={this.state.access_token}\n                />\n            </View>\n        );\n    }\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect-promise';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK App\nconnect.send('VKWebAppInit', {})\n    .then(res => console.log('VKWebAppInit', res))\n    .catch(e => console.error('ERR VKWebAppInit', e));\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT \n// registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}
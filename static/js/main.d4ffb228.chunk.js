(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,n){e.exports=n(350)},350:function(e,t,n){"use strict";n.r(t);var r=n(54),s=n(1),o=n.n(s),a=n(104),c=n.n(a),i=(n(331),n(332),n(144)),l=n(67),u=n(68),d=n(70),f=n(69),h=n(71),p=n(2),m=(n(349),n(142)),v=n.n(m),k=function(e,t){return v()(function(e,t){var n="";return Object.keys(t).forEach(function(e){return n+="".concat(e,"=").concat(t[e],"&")}),"https://api.vk.com/method/".concat(e,"?").concat(n,"v=5.80")}(e,t)).then(function(e){return e.json()}).catch(function(e){return console.error(e)})},E=function(e){return k("users.get",e)},b=function(e){return k("friends.get",e)},g=function(e){return k("friends.delete",e)},I=function(e){var t=e.id,n=e.go,r=e.fetchedUser;return o.a.createElement(p.Panel,{id:t},o.a.createElement(p.PanelHeader,null,"\u0412\u041a \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"),r&&o.a.createElement(p.Group,{title:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"},o.a.createElement(p.ListItem,{before:r.photo_200?o.a.createElement(p.Avatar,{src:r.photo_200}):null,description:r.city&&r.city.title?r.city.title:""},"".concat(r.first_name," ").concat(r.last_name))),o.a.createElement(p.Group,{title:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},o.a.createElement(p.Div,null,o.a.createElement(p.Button,{size:"xl",level:"2",onClick:n,"data-to":"friends"},"\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438")),o.a.createElement(p.Div,null,o.a.createElement(p.Button,{size:"xl",level:"2",onClick:n,"data-to":"friends"},"\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u0430\u043c\u0438")),o.a.createElement(p.Div,null,o.a.createElement(p.Button,{size:"xl",level:"2",onClick:n,"data-to":"friends"},"\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0435\u043d\u043e\u0439"))))},_=n(143),y=n.n(_),A=n(105),F=n.n(A),j=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={progress:0,countFriends:0,isDelAllFriends:!1},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"deleteFriend",value:function(e){var t=this;return function(){g({user_id:e,access_token:t.props.access_token}).then(function(n){if(n.error)console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",n.error);else{var r=t.props.usersInfo.findIndex(function(t){return t.id===e});t.props.usersInfo.splice(r,1),t.forceUpdate()}}).catch(function(e){return console.error(e)})}}},{key:"deleteAllFriends",value:function(){var e=this,t=!this.props.usersInfo.length;this.setState({isDelAllFriends:!0}),this.interval=setInterval(function(){t&&clearInterval(e.interval),g({user_id:e.props.usersInfo[0].id,access_token:e.props.access_token}).then(function(t){t.error?console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",t.error):(e.props.usersInfo.splice(0,1),e.setState(function(e){return e.progress++}),e.forceUpdate())}).catch(function(e){return console.error(e)})},3e3)}},{key:"cancelDelFriends",value:function(){clearInterval(this.interval),this.setState({isDelAllFriends:!1})}},{key:"componentDidMount",value:function(){this.setState({countFriends:this.props.usersInfo.length})}},{key:"render",value:function(){var e=this;return o.a.createElement(p.Panel,{id:this.props.id},o.a.createElement(p.PanelHeader,{left:o.a.createElement(p.HeaderButton,{onClick:this.props.go,"data-to":"home"},this.osname===p.IOS?o.a.createElement(y.a,null):o.a.createElement(F.a,null))},"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f."),o.a.createElement(p.Group,{title:""},o.a.createElement(p.Div,{style:{display:"flex",zIndex:100}},o.a.createElement(p.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:this.deleteAllFriends.bind(this)},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435\u0445 \u0434\u0440\u0443\u0437\u0435\u0439"),o.a.createElement(p.Button,{size:"l",stretched:!0,level:"secondary",onClick:this.cancelDelFriends.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435")),this.state.isDelAllFriends&&o.a.createElement(p.Cell,{description:"\u0443\u0434\u0430\u043b\u0435\u043d\u043e ".concat(this.state.progress," / ").concat(this.state.countFriends)},o.a.createElement(p.Progress,{value:this.state.progress}))),o.a.createElement(p.Group,{title:"Standart size"},this.state.isDelAllFriends&&o.a.createElement(p.Div,{style:{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:98,background:"#ffffff45"}},o.a.createElement(p.Spinner,{size:"large",style:{position:"fixed",zIndex:99}})),this.props.usersInfo.map(function(t){return o.a.createElement(p.Cell,{size:"l",description:t.status||"\u0421\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d",before:o.a.createElement(p.Avatar,{src:t.photo_200_orig}),bottomContent:o.a.createElement(p.Button,{onClick:e.deleteFriend(t.id)},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),key:t.id},"".concat(t.first_name," ").concat(t.last_name))})))}}]),t}(o.a.Component),D=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).go=function(e){n.setState({activePanel:e.currentTarget.dataset.to})},n.state={activePanel:"home",fetchedUser:null,access_token:"10e034eddee1017397f6fb967350f1daf7621e9f3387c100763dbd90ec76dff932db8d2c5732c3b9f33bc",friendsIds:null,usersInfo:[]},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;r.a.send("VKWebAppGetAuthToken",{app_id:6940370,scope:"friends,status,wall,groups,photos,video,pages,notes,docs,stats,market"}).then(function(t){console.log("VKWebAppGetAuthToken",t),e.getFriends()}).catch(function(e){return console.error(e)}),r.a.send("VKWebAppGetUsersInfo",{}).then(function(t){return e.setState({fetchedUser:t.data})}).catch(function(e){return console.error(e)})}},{key:"getFriends",value:function(){var e=this;b({count:5e3,access_token:this.state.access_token}).then(function(t){e.setState({friendsIds:t.response.items}),e.getUsersInfo()}).catch(function(e){return console.error(e)})}},{key:"getUsersInfo",value:function(){var e=this,t=this.state.friendsIds.slice(0,100).join(",");E({user_ids:t,fields:"photo_200_orig,status",access_token:this.state.access_token}).then(function(t){e.setState(function(e){var n;(n=e.usersInfo).push.apply(n,Object(i.a)(t.response))})}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return o.a.createElement(p.View,{activePanel:this.state.activePanel},o.a.createElement(I,{id:"home",fetchedUser:this.state.fetchedUser,go:this.go,access_token:this.state.access_token}),o.a.createElement(j,{id:"friends",go:this.go,access_token:this.state.access_token,usersInfo:this.state.usersInfo}))}}]),t}(o.a.Component);r.a.send("VKWebAppInit",{}).then(function(e){return console.log("VKWebAppInit success:",e)}).catch(function(e){return console.error("VKWebAppInit error:",e)}),c.a.render(o.a.createElement(D,null),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.d4ffb228.chunk.js.map